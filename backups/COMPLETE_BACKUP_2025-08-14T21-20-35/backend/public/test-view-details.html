<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test View Details</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container" style="padding: 2rem;">
        <h1>Test View Details Functionality</h1>
        
        <div class="result-card" style="margin: 2rem 0;">
            <div class="card-header">
                <h3>A J Institute of Medical Sciences & Research Centre, Mangalore</h3>
                <span class="result-type medical">medical</span>
            </div>
            
            <div class="result-meta">
                <span class="meta-item">
                    <i class="fas fa-map-marker-alt"></i>
                    Karnataka
                </span>
                <span class="meta-item">
                    <i class="fas fa-chair"></i>
                    200 seats
                </span>
                <span class="meta-item">
                    <i class="fas fa-book"></i>
                    M.B.B.S.
                </span>
            </div>
            
            <div class="card-actions">
                <button class="btn btn-primary" onclick="testViewDetails(267)">
                    <i class="fas fa-eye"></i> View Details
                </button>
                <button class="btn btn-secondary" onclick="testTrackCollege(267)">
                    <i class="fas fa-heart"></i> Track
                </button>
            </div>
        </div>
        
        <div id="debug-info" style="margin-top: 2rem; padding: 1rem; background: #f0f0f0; border-radius: 8px;">
            <h3>Debug Information</h3>
            <div id="debug-content">Click the View Details button to test...</div>
        </div>
    </div>

    <script>
        async function testViewDetails(collegeId) {
            const debugContent = document.getElementById('debug-content');
            debugContent.innerHTML = 'Loading college details...';
            
            try {
                console.log('Testing view details for college ID:', collegeId);
                
                const response = await fetch(`/api/colleges/${collegeId}`);
                console.log('API Response:', response);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const college = await response.json();
                console.log('College data:', college);
                
                debugContent.innerHTML = `
                    <h4>College Details Loaded Successfully!</h4>
                    <p><strong>Name:</strong> ${college.name}</p>
                    <p><strong>Type:</strong> ${college.type}</p>
                    <p><strong>State:</strong> ${college.state}</p>
                    <p><strong>Seats:</strong> ${college.seats}</p>
                    <p><strong>Course:</strong> ${college.course}</p>
                    <p><strong>Management:</strong> ${college.management_type || 'Not specified'}</p>
                    <p><strong>University:</strong> ${college.university || 'Not specified'}</p>
                    <p><strong>Established:</strong> ${college.year_established || 'Not specified'}</p>
                `;
                
                // Now test the modal
                showTestModal(college);
                
            } catch (error) {
                console.error('Error testing view details:', error);
                debugContent.innerHTML = `
                    <h4>Error Loading College Details</h4>
                    <p style="color: red;">${error.message}</p>
                `;
            }
        }
        
        function showTestModal(college) {
            const modalHTML = `
                <div class="college-details-modal" id="testModal" style="display: block;">
                    <div class="modal-overlay" onclick="closeTestModal()"></div>
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>${college.name}</h2>
                            <button class="modal-close" onclick="closeTestModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="modal-body">
                            <div class="college-info-grid">
                                <div class="info-section">
                                    <h3><i class="fas fa-university"></i> Institution Details</h3>
                                    <div class="info-item">
                                        <span class="label">Type:</span>
                                        <span class="value ${college.type}">${college.type}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">State:</span>
                                        <span class="value">${college.state}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">Management:</span>
                                        <span class="value">${college.management_type || 'Not specified'}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">University:</span>
                                        <span class="value">${college.university || 'Not specified'}</span>
                                    </div>
                                    ${college.year_established ? `
                                        <div class="info-item">
                                            <span class="label">Established:</span>
                                            <span class="value">${college.year_established}</span>
                                        </div>
                                    ` : ''}
                                </div>
                                
                                <div class="info-section">
                                    <h3><i class="fas fa-book"></i> Course Information</h3>
                                    <div class="info-item">
                                        <span class="label">Course:</span>
                                        <span class="value">${college.course || 'Not specified'}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">Available Seats:</span>
                                        <span class="value seats">${college.seats || 0}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="modal-footer">
                            <button class="btn btn-primary" onclick="closeTestModal()">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Show modal with animation
            setTimeout(() => {
                const modal = document.getElementById('testModal');
                modal.classList.add('show');
            }, 10);
            
            document.body.style.overflow = 'hidden';
        }
        
        function closeTestModal() {
            const modal = document.getElementById('testModal');
            if (modal) {
                modal.classList.remove('show');
                setTimeout(() => {
                    modal.remove();
                    document.body.style.overflow = '';
                }, 300);
            }
        }
        
        function testTrackCollege(collegeId) {
            const debugContent = document.getElementById('debug-content');
            debugContent.innerHTML = `
                <h4>Track College Functionality</h4>
                <p>Tracking college ID: ${collegeId}</p>
                <p>This would normally add the college to a tracking list.</p>
            `;
        }
    </script>
</body>
</html>
